"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BottomSheetContainer=BottomSheetContainer;const jsx_runtime_1=require("react/jsx-runtime"),tds_easings_1=require("@toss/tds-easings"),react_1=require("react"),react_native_1=require("react-native"),core_1=require("../../core"),utils_1=require("../../utils"),DragAnimation_1=require("./DragAnimation"),usePreservedCallback_1=require("./utils/usePreservedCallback"),defaultSafeAreaBottom=10,noop=()=>{};function BottomSheetContainer({open:t,children:u,onDragFinished:l,onDragToClose:d,onDraggedDown:g,onDraggedMiddle:h,onDraggedUp:m,onExited:f,style:v,unstable_disableDragging:b=!1}){const r=(0,react_native_1.useWindowDimensions)(),y=(0,core_1.useAdaptive)(),a=(0,usePreservedCallback_1.usePreservedCallback)(f??noop),p=(0,react_1.useRef)(0),n=(0,react_1.useRef)(new react_native_1.Animated.Value(r.height)).current,s=(0,utils_1.useSafeAreaBottom)()||defaultSafeAreaBottom,{typographyLevel:c}=(0,core_1.useTypographyTheme)(),S=react_native_1.Platform.OS==="android"?c>150:c?.startsWith("A11y"),_=r.height*(S?.9:.7),e=(0,react_1.useCallback)(({moveTo:o})=>react_native_1.Animated.spring(n,{toValue:o,useNativeDriver:!0,...tds_easings_1.spring.quick}),[n]);return(0,react_1.useEffect)(()=>{if(t)return e({moveTo:-s}).start(),()=>{e({moveTo:r.height}).start(()=>{a?.()})}},[e,r.height,a,t,s]),(0,react_1.useEffect)(()=>{if(!t||react_native_1.Platform.OS!=="ios")return;const o=react_native_1.Keyboard.addListener("keyboardWillShow",w=>{const A=w.endCoordinates.height;e({moveTo:-(defaultSafeAreaBottom+A)}).start()}),i=react_native_1.Keyboard.addListener("keyboardWillHide",()=>{e({moveTo:-s}).start()});return()=>{o.remove(),i.remove()}},[e,s,t]),(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{style:[styles.wrapper,{transform:[{translateY:n}]}],children:(0,jsx_runtime_1.jsx)(DragAnimation_1.BottomSheetDragAnimation,{onDraggedUp:m,onDraggedMiddle:h,onDraggedDown:g,onDragToClose:d,onDragFinished:l,unstable_disableDragging:b,style:[styles.container,{backgroundColor:y.layeredBackground,maxHeight:_,width:r.width-20},v],onLayout:o=>{const i=o.nativeEvent.layout.height;p.current=i,t||n.setValue(i)},children:u})})}const styles=react_native_1.StyleSheet.create({wrapper:{position:"absolute",bottom:0},container:{bottom:0,borderRadius:28,left:10}});
