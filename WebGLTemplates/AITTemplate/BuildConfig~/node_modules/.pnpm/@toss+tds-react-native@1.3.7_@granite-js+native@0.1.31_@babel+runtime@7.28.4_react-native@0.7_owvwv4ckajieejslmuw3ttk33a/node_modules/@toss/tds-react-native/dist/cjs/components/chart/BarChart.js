"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BarChart=void 0;const jsx_runtime_1=require("react/jsx-runtime"),react_native_svg_1=require("@granite-js/native/react-native-svg"),react_native_1=require("@granite-js/react-native"),tds_colors_1=require("@toss/tds-colors"),react_1=require("react"),react_native_2=require("react-native"),core_1=require("../../core"),txt_1=require("../txt");function Bar({borderRadius:o,backgroundColor:e=tds_colors_1.colors.grey100,...s}){const a="bar-background-color",n=`0 0 ${s.width} ${s.height}`;return(0,jsx_runtime_1.jsxs)(react_native_svg_1.Svg,{viewBox:n,...s,children:[(0,jsx_runtime_1.jsx)(react_native_svg_1.Defs,{children:(0,jsx_runtime_1.jsxs)(react_native_svg_1.RadialGradient,{id:a,cx:"0%",cy:"100%",r:"100%",fx:"0%",fy:"100%",gradientUnits:"objectBoundingBox",children:[(0,jsx_runtime_1.jsx)(react_native_svg_1.Stop,{offset:"0%",stopColor:typeof e=="string"?e:e[0]}),(0,jsx_runtime_1.jsx)(react_native_svg_1.Stop,{offset:"100%",stopColor:typeof e=="string"?e:e[1]})]})}),(0,jsx_runtime_1.jsx)(react_native_svg_1.Rect,{width:s.width??"100%",height:s.height??"100%",fill:`url(#${a})`,rx:o,ry:o})]})}function XAxisLabel({style:o,color:e=tds_colors_1.colors.grey600,...s}){return(0,jsx_runtime_1.jsx)(txt_1.Txt,{style:[{marginTop:6,paddingHorizontal:4},o],typography:"st13",color:e,fontWeight:"medium",textAlign:"center",...s})}function BarAnnotation({style:o,color:e=tds_colors_1.colors.grey500,...s}){return(0,jsx_runtime_1.jsx)(txt_1.Txt,{style:[{marginBottom:6,paddingHorizontal:6},o],typography:"st12",color:e,fontWeight:"medium",textAlign:"center",...s})}function BarContainer({gutter:o=0,...e}){return(0,jsx_runtime_1.jsx)(react_native_1.Stack,{direction:"vertical",align:"center",justify:"flex-end",gutter:o,...e})}function ChartArea({gutter:o=0,...e}){return(0,jsx_runtime_1.jsx)(react_native_1.Stack,{direction:"horizontal",justify:"center",gutter:o,...e})}function XAxisArea({gutter:o=0,...e}){return(0,jsx_runtime_1.jsx)(react_native_1.Stack,{direction:"horizontal",justify:"center",gutter:o,...e})}const{width:WINDOW_WIDTH}=react_native_2.Dimensions.get("window");exports.BarChart=(0,react_1.forwardRef)(function({data:e=[],width:s=WINDOW_WIDTH,height:a=205,fill:n={type:"all-bar",theme:"blue"},style:x,...f},j){const t=(0,core_1.useAdaptive)(),A=48,B=24,_=23,p=58,C=38,H=s-A,M=a-B-_,S=Math.max(...e.map(({value:r})=>r)),d=Math.floor(Math.min(H/e.length,p)),W=M*.7,m=r=>Math.floor(r/S*W),g=Math.round(C/p*d),w=g>=30?8:g>9?Math.floor(g/5+2):3,c=(0,react_1.useMemo)(()=>({default:t.grey100,blue:[t.blue300,t.blue500],green:[t.green200,t.green400],yellow:[t.yellow300,t.yellow500],orange:[t.orange300,t.orange500],red:[t.red300,t.red500],grey:[t.grey400,t.grey500]}),[t]),l=(0,react_1.useMemo)(()=>({default:t.grey500,blue:t.blue700,green:t.green800,yellow:t.yellow900,orange:t.orange900,red:t.red700,grey:t.grey700}),[t]),b=[n.type,n.theme,n.count],v=(0,react_1.useMemo)(()=>{const r=c.default;if(n.type==="auto"){const u=[c.blue,c.green,c.yellow,c.orange,c.red,c.grey];return new Array(e.length).fill(r).map((y,h)=>h<n.count?u[h%u.length]:y).reverse()}const i=c[n.theme]??n.theme;return n.type==="single-bar"?[...new Array(e.length-1).fill(r),i]:new Array(e.length).fill(i)},[...b,e.length,c]),q=(0,react_1.useMemo)(()=>{const r=l.default;if(n.type==="auto"){const u=[l.blue,l.green,l.yellow,l.orange,l.red,l.grey];return new Array(e.length).fill(r).map((y,h)=>h<n.count?u[h%u.length]:y).reverse()}const i=l[n.theme]??n.theme;return n.type==="single-bar"?[...new Array(e.length-1).fill(r),i]:new Array(e.length).fill(r)},[...b,e.length,l]);return e.length<=12?(0,jsx_runtime_1.jsxs)(react_native_1.Stack,{ref:j,style:[{paddingHorizontal:24,paddingVertical:12,minHeight:a},x],gutter:0,...f,children:[(0,jsx_runtime_1.jsx)(ChartArea,{children:e.map(({value:r},i)=>(0,jsx_runtime_1.jsxs)(BarContainer,{style:{width:d},children:[(0,jsx_runtime_1.jsx)(BarAnnotation,{color:q[i],children:r}),(0,jsx_runtime_1.jsx)(Bar,{width:g,height:m(r),borderRadius:w,backgroundColor:v[i]})]},i))}),(0,jsx_runtime_1.jsx)(XAxisArea,{children:e.map(({xAxisLabel:r},i)=>(0,jsx_runtime_1.jsx)(XAxisLabel,{style:{width:d},children:r},i))})]}):(0,jsx_runtime_1.jsxs)(react_native_1.Stack,{ref:j,style:[{paddingHorizontal:24,paddingVertical:12,minHeight:a},x],gutter:0,...f,children:[(0,jsx_runtime_1.jsx)(ChartArea,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:e.map(({value:r},i)=>(0,jsx_runtime_1.jsx)(BarContainer,{style:{width:d},children:(0,jsx_runtime_1.jsx)(Bar,{width:g,height:m(r),borderRadius:w,backgroundColor:v[i]})},i))}),(0,jsx_runtime_1.jsxs)(XAxisArea,{justify:"space-between",children:[(0,jsx_runtime_1.jsx)(XAxisLabel,{children:e[0]?.xAxisLabel}),(0,jsx_runtime_1.jsx)(XAxisLabel,{children:e[e.length-1]?.xAxisLabel})]})]})});
