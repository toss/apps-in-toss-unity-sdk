"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slider=void 0;const jsx_runtime_1=require("react/jsx-runtime"),react_native_gesture_handler_1=require("@granite-js/native/react-native-gesture-handler"),tds_colors_1=require("@toss/tds-colors"),react_1=require("react"),react_native_1=require("react-native"),styles_1=require("./styles"),useA11yMode_1=require("./useA11yMode"),utils_1=require("./utils");exports.Slider=(0,react_1.forwardRef)(function({min:r=0,max:n=100,value:i=r+n/2,step:o=1,onChange:l,color:_=tds_colors_1.colors.blue400,style:m,...p},V){if(!Number.isInteger(o)||o<=0)throw new Error("step\uC740 \uC591\uC758 \uC815\uC218\uB9CC \uC0AC\uC6A9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4");const[s,b]=(0,react_1.useState)({container:0,thumb:0}),a=(0,react_1.useRef)(new react_native_1.Animated.Value(0)).current,u=s.container!==0&&s.thumb!==0,v=e=>{const t=s.container,c=s.thumb,y=t-c;return e===void 0||t===0||c===0||e<=c/2?r:e>=t-c/2?n:(0,utils_1.getNearestSteppedValue)(r+(n-r)*((e-c/2)/y),r,n,o)},d=e=>{const t=s.container,c=s.thumb,y=t-c;return(e-r)/(n-r)*y},h=e=>{const t=v(e);l?.(t),a.setValue(d(t))},w=(0,react_1.useMemo)(()=>react_native_gesture_handler_1.Gesture.Pan().onUpdate(e=>{h(e.x)}).onStart(e=>{h(e.x)}),[u]);(0,react_1.useEffect)(()=>{u&&a.setValue(d(i))},[u]);const f=(0,useA11yMode_1.useScreenReaderMode)();(0,react_1.useEffect)(()=>{f&&a.setValue(d(i))},[f,i]);const j=e=>{switch(e.nativeEvent.actionName){case"increment":l?.((0,utils_1.clamp)(i+o,r,n));break;case"decrement":l?.((0,utils_1.clamp)(i-o,r,n));break;default:break}};return(0,jsx_runtime_1.jsx)(react_native_gesture_handler_1.GestureDetector,{gesture:w,children:(0,jsx_runtime_1.jsxs)(react_native_1.View,{ref:V,style:[styles_1.styles.slider,m],onLayout:e=>{const{width:t}=e.nativeEvent.layout;b({...s,container:t})},accessible:!0,accessibilityRole:"adjustable",accessibilityValue:{text:`${i}`},accessibilityActions:[{name:"increment"},{name:"decrement"}],accessibilityLiveRegion:"polite",onAccessibilityAction:j,...p,children:[(0,jsx_runtime_1.jsx)(react_native_1.View,{style:styles_1.styles.track,pointerEvents:"none",children:(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{style:[styles_1.styles.progress,{backgroundColor:_,transform:[{translateX:a}]}]})}),(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{onLayout:e=>{const{width:t}=e.nativeEvent.layout;b({...s,thumb:t})},style:[styles_1.styles.thumb,{opacity:u?1:0,transform:[{translateX:a}]}],pointerEvents:"none"})]})})});
