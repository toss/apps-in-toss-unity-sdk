"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Navigation=Navigation,exports.useBackOrCloseNavigation=useBackOrCloseNavigation,exports.NavigationBackdrop=NavigationBackdrop,exports.NavigationLeft=NavigationLeft,exports.NavigationRight=NavigationRight,exports.NavigationCenter=NavigationCenter,exports.NavigationTitleIcon=NavigationTitleIcon,exports.NavigationTitleText=NavigationTitleText,exports.NavigationBackButton=NavigationBackButton,exports.NavigationCloseButton=NavigationCloseButton;const jsx_runtime_1=require("react/jsx-runtime"),elements_1=require("@granite-js/native/@react-navigation/elements"),native_1=require("@granite-js/native/@react-navigation/native"),react_native_1=require("@granite-js/react-native"),tds_colors_1=require("@toss/tds-colors"),react_1=require("react"),react_native_2=require("react-native"),asset_1=require("../../components/asset"),gradient_1=require("../../components/gradient"),navbar_1=require("../../components/navbar"),shadow_1=require("../../components/shadow"),txt_1=require("../../components/txt"),ColorPreferenceProvider_1=require("../../core/contexts/ColorPreferenceProvider"),prevent_font_scaling_1=require("../../extensions/prevent-font-scaling");function useAdaptive(){const{colorPreference:e}=(0,ColorPreferenceProvider_1.useColorPreference)(),{adaptive:t}=(0,react_1.useMemo)(()=>({adaptive:tds_colors_1.colorsByPreference[e]}),[e]);return t}function hasValidChild(e){return react_1.Children.toArray(e).length>0}function Navigation({children:e}){const t=(0,native_1.useNavigation)(),n=useAdaptive(),{colorPreference:o}=(0,ColorPreferenceProvider_1.useColorPreference)(),r=hasValidChild(e);return(0,react_1.useLayoutEffect)(()=>{function i(){t.setOptions({headerStyle:null,statusBarStyle:"auto"})}if(!r){i();return}return t.setOptions({headerStyle:{backgroundColor:n.background},statusBarStyle:"auto"}),()=>{i()}},[t,o,r,n.background]),(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:e})}function useBackOrCloseNavigation(){const e=(0,native_1.useNavigation)();return(0,react_1.useCallback)(()=>{e.canGoBack()?e.goBack():(0,react_native_1.closeView)()},[e])}const BACKDROP_SHADOW_COLOR=react_native_2.Platform.select({android:tds_colors_1.colors.greyOpacity400,ios:tds_colors_1.colors.greyOpacity100,default:tds_colors_1.colors.greyOpacity100});function NavigationBackdrop(){const{colorPreference:e}=(0,ColorPreferenceProvider_1.useColorPreference)(),t=useAdaptive(),n=(0,elements_1.useHeaderHeight)(),o=e==="dark",r=(0,shadow_1.useShadow)({offset:{x:0,y:0},opacity:1,radius:o?50:20,color:o?"rgba(0, 0, 0, 0.1)":BACKDROP_SHADOW_COLOR}),i=o?[t.grey100,t.grey300,t.grey100]:[t.greyOpacity100,t.greyOpacity300,t.greyOpacity100];return(0,jsx_runtime_1.jsxs)(react_native_2.View,{pointerEvents:"none",style:[{position:"absolute",top:-n,left:0,right:0,zIndex:1,width:"100%",height:n+.5}],children:[(0,jsx_runtime_1.jsx)(react_native_2.View,{pointerEvents:"none",style:[{position:"absolute",top:0,left:0,right:0,backgroundColor:t.background,width:"100%",height:n},r]}),(0,jsx_runtime_1.jsx)(gradient_1.LinearGradient,{degree:90,easing:"linear",positions:[0,.5,1],colors:i})]})}function NavigationLeft({children:e,visible:t=!0}){const n=(0,native_1.useNavigation)();return(0,react_1.useLayoutEffect)(()=>{if(!hasValidChild(e)||!t){n.setOptions({headerLeft:null});return}n.setOptions({headerLeft:()=>(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:e})})},[e,n,t]),null}function NavigationRight({children:e,visible:t=!0}){const n=(0,native_1.useNavigation)();return(0,react_1.useLayoutEffect)(()=>{if(!hasValidChild(e)||!t){n.setOptions({headerRight:null});return}n.setOptions({headerRight:()=>(0,jsx_runtime_1.jsx)(react_native_2.View,{style:{marginRight:4,flexDirection:"row"},children:e})})},[e,n,t]),null}const DEVICE_WIDTH=react_native_2.Dimensions.get("window").width;function NavigationCenter({children:e,visible:t=!0}){const o=(0,native_1.useNavigation)();return(0,react_1.useLayoutEffect)(()=>{if(!hasValidChild(e)||!t){o.setOptions({headerBackVisible:!1,headerTitle:null});return}o.setOptions({headerTitleAlign:"center",headerBackVisible:!1,headerTitle:()=>(0,jsx_runtime_1.jsx)(react_native_2.View,{style:[{maxWidth:DEVICE_WIDTH-100,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:5}],children:e})})},[e,o,t]),null}function NavigationTitleIcon(e){const t={width:16,height:16,radius:5};return e.name!==void 0?(0,jsx_runtime_1.jsx)(asset_1.Asset.Icon,{name:e.name,frameShape:t}):(0,jsx_runtime_1.jsx)(react_native_2.Image,{source:e.source,style:{overflow:"hidden",borderRadius:t.radius,width:t.width,height:t.height}})}function NavigationTitleText({style:e,...t}){const n=useAdaptive();return(0,jsx_runtime_1.jsx)(prevent_font_scaling_1.PreventFontScaling,{limit:100,children:(0,jsx_runtime_1.jsx)(txt_1.Txt,{typography:"st10",fontWeight:"semibold",color:n.grey900,numberOfLines:1,ellipsizeMode:"tail",...t})})}function NavigationBackButton({onPress:e,canGoBack:t=!0}){const{colorPreference:n}=(0,ColorPreferenceProvider_1.useColorPreference)(),o=useAdaptive(),r=n==="light"?o.greyOpacity400:o.greyOpacity500,i=useBackOrCloseNavigation();return(0,jsx_runtime_1.jsx)(navbar_1.ReactNavigationNavbar.BackButton,{tintColor:r,onPress:()=>{e?.(),t&&i()}})}function NavigationCloseButton({onPress:e}){const{colorPreference:t}=(0,ColorPreferenceProvider_1.useColorPreference)(),n=useAdaptive(),o=t==="light"?n.greyOpacity400:n.greyOpacity500;return(0,jsx_runtime_1.jsx)(navbar_1.ReactNavigationNavbar.CloseButton,{tintColor:o,onPress:()=>{e?.(),(0,react_native_1.closeView)()}})}
