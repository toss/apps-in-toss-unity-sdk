    __{{name}}_Internal: function({{#each parameters}}{{name}}{{#unless @last}}, {{/unless}}{{/each}}{{#if hasCallback}}{{#if parameters.length}}, {{/if}}callbackId, typeName{{/if}}) {
{{#if isAsync}}
        // 비동기 함수 (Promise 반환)
        var callback = UTF8ToString(callbackId);
        var typeNameStr = UTF8ToString(typeName);

        console.log('[AIT jslib] {{name}} called, callbackId:', callback);
{{#each parameters}}
        console.log('[AIT jslib] {{../name}} raw param {{name}}:', UTF8ToString({{name}}));
{{/each}}

        try {
{{#if namespace}}
            var promiseResult = window.AppsInToss.{{namespace}}.{{originalName}}({{#each parameters}}{{jsConversion}}{{#unless @last}}, {{/unless}}{{/each}});
{{else}}
            var promiseResult = window.AppsInToss.{{originalName}}({{#each parameters}}{{jsConversion}}{{#unless @last}}, {{/unless}}{{/each}});
{{/if}}
            console.log('[AIT jslib] {{originalName}} returned:', promiseResult, 'isPromise:', promiseResult && typeof promiseResult.then === 'function');

            if (!promiseResult || typeof promiseResult.then !== 'function') {
                // Promise가 아닌 경우 (undefined, null 등) - 즉시 응답
                console.log('[AIT jslib] {{originalName}} did not return a Promise, sending immediate response');
                var payload = JSON.stringify({
                    CallbackId: callback,
                    TypeName: typeNameStr,
                    Result: JSON.stringify({ success: true, data: JSON.stringify(promiseResult), error: '' })
                });
                SendMessage('AITCore', 'OnAITCallback', payload);
                return;
            }

            promiseResult
                .then(function(result) {
                    console.log('[AIT jslib] {{originalName}} resolved:', result);
{{#if isDiscriminatedUnion}}
                    var resultPayload;
                    if (typeof result === 'string') {
                        resultPayload = { _type: "error", _errorCode: result, _successJson: "" };
                    } else {
                        resultPayload = { _type: "success", _successJson: JSON.stringify(result), _errorCode: "" };
                    }
                    var payload = JSON.stringify({
                        CallbackId: callback,
                        TypeName: typeNameStr,
                        Result: JSON.stringify({ success: true, data: JSON.stringify(resultPayload), error: '' })
                    });
{{else}}
                    var payload = JSON.stringify({
                        CallbackId: callback,
                        TypeName: typeNameStr,
                        Result: JSON.stringify({ success: true, data: JSON.stringify(result), error: '' })
                    });
{{/if}}
                    SendMessage('AITCore', 'OnAITCallback', payload);
                })
                .catch(function(error) {
                    console.log('[AIT jslib] {{originalName}} rejected:', error);
                    var payload = JSON.stringify({
                        CallbackId: callback,
                        TypeName: typeNameStr,
                        Result: JSON.stringify({ success: false, data: '', error: error.message || String(error) })
                    });
                    SendMessage('AITCore', 'OnAITCallback', payload);
                });
        } catch (error) {
            console.log('[AIT jslib] {{originalName}} sync error:', error);
            var payload = JSON.stringify({
                CallbackId: callback,
                TypeName: typeNameStr,
                Result: JSON.stringify({ success: false, data: '', error: error.message || String(error) })
            });
            SendMessage('AITCore', 'OnAITCallback', payload);
        }
{{else}}
        // 동기 함수 (즉시 값 반환)
        var callback = UTF8ToString(callbackId);
        var typeNameStr = UTF8ToString(typeName);

        try {
{{#if namespace}}
            var result = window.AppsInToss.{{namespace}}.{{originalName}}({{#each parameters}}{{jsConversion}}{{#unless @last}}, {{/unless}}{{/each}});
{{else}}
            var result = window.AppsInToss.{{originalName}}({{#each parameters}}{{jsConversion}}{{#unless @last}}, {{/unless}}{{/each}});
{{/if}}
            var payload = JSON.stringify({
                CallbackId: callback,
                TypeName: typeNameStr,
                Result: JSON.stringify({ success: true, data: JSON.stringify(result), error: '' })
            });
            SendMessage('AITCore', 'OnAITCallback', payload);
        } catch (error) {
            var payload = JSON.stringify({
                CallbackId: callback,
                TypeName: typeNameStr,
                Result: JSON.stringify({ success: false, data: '', error: error.message || String(error) })
            });
            SendMessage('AITCore', 'OnAITCallback', payload);
        }
{{/if}}
    },
